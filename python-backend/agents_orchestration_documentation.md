–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –º–æ–¥—É–ª—è –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏–∏ –∞–≥–µ–Ω—Ç–æ–≤
üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

    –û–±—â–µ–µ –æ–ø–∏—Å–∞–Ω–∏–µ

    –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –º–æ–¥—É–ª—è

    –ë–∞–∑–æ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

    –°—Ç—Ä–∞—Ç–µ–≥–∏–∏ –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏–∏

    –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å YandexGPT

    –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

    API Reference

–û–±—â–µ–µ –æ–ø–∏—Å–∞–Ω–∏–µ

–ú–æ–¥—É–ª—å –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏–∏ –∞–≥–µ–Ω—Ç–æ–≤ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –º–Ω–æ–∂–µ—Å—Ç–≤–æ–º AI-–∞–≥–µ–Ω—Ç–æ–≤ –∏ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –∏—Ö –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è. –û–Ω –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å —Å–ª–æ–∂–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –æ–±—â–µ–Ω–∏—è –º–µ–∂–¥—É –∞–≥–µ–Ω—Ç–∞–º–∏, –≤–º–µ—à–∞—Ç–µ–ª—å—Å—Ç–≤–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ —Ä–∞–∑–ª–∏—á–Ω—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –≤–µ–¥–µ–Ω–∏—è –¥–∏–∞–ª–æ–≥–∞.

–ö–ª—é—á–µ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:

    –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–Ω–æ–∂–µ—Å—Ç–≤–æ–º –∞–≥–µ–Ω—Ç–æ–≤

    –†–∞–∑–ª–∏—á–Ω—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è

    –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ —Ä–∞–∑–≥–æ–≤–æ—Ä–∞

    –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å YandexGPT

    –†–∞—Å—à–∏—Ä—è–µ–º–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –º–æ–¥—É–ª—è
text

agents_orchestration/
‚îú‚îÄ‚îÄ __init__.py                 # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–∞–∫–µ—Ç–∞
‚îú‚îÄ‚îÄ message_type.py              # –¢–∏–ø—ã —Å–æ–æ–±—â–µ–Ω–∏–π (Enum)
‚îú‚îÄ‚îÄ message.py                   # –ú–æ–¥–µ–ª—å —Å–æ–æ–±—â–µ–Ω–∏—è
‚îú‚îÄ‚îÄ context.py                   # –ö–æ–Ω—Ç–µ–∫—Å—Ç —Ä–∞–∑–≥–æ–≤–æ—Ä–∞
‚îú‚îÄ‚îÄ base_strategy.py             # –ë–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏
‚îú‚îÄ‚îÄ orchestration_client.py      # –û—Å–Ω–æ–≤–Ω–æ–π –∫–ª–∏–µ–Ω—Ç
‚îú‚îÄ‚îÄ strategies/
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ circular.py              # –¶–∏—Ä–∫—É–ª—è—Ä–Ω–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ narrator.py              # –°—Ç—Ä–∞—Ç–µ–≥–∏—è —Å —Ä–∞—Å—Å–∫–∞–∑—á–∏–∫–æ–º
‚îÇ   ‚îî‚îÄ‚îÄ full_context.py           # –°—Ç—Ä–∞—Ç–µ–≥–∏—è –ø–æ–ª–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
‚îî‚îÄ‚îÄ examples/
    ‚îî‚îÄ‚îÄ usage.py                  # –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

–ë–∞–∑–æ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
1. –¢–∏–ø—ã —Å–æ–æ–±—â–µ–Ω–∏–π (MessageType)
python

from enum import Enum

class MessageType(Enum):
    USER = "user"              # –°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    AGENT = "agent"            # –°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç –∞–≥–µ–Ω—Ç–∞
    SYSTEM = "system"          # –°–∏—Å—Ç–µ–º–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
    NARRATOR = "narrator"      # –°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç —Ä–∞—Å—Å–∫–∞–∑—á–∏–∫–∞
    SUMMARIZED = "summarized"  # –°–≤–æ–¥–∫–∞ –æ–±—Å—É–∂–¥–µ–Ω–∏—è

2. –ú–æ–¥–µ–ª—å —Å–æ–æ–±—â–µ–Ω–∏—è (Message)
python

@dataclass
class Message:
    content: str                    # –¢–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è
    type: MessageType               # –¢–∏–ø —Å–æ–æ–±—â–µ–Ω–∏—è
    sender: str                     # –û—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—å
    timestamp: datetime             # –í—Ä–µ–º—è –æ—Ç–ø—Ä–∞–≤–∫–∏
    metadata: Dict[str, Any]        # –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ
    target_agent: Optional[str]     # –¶–µ–ª–µ–≤–æ–π –∞–≥–µ–Ω—Ç
    round_number: int                # –ù–æ–º–µ—Ä —Ä–∞—É–Ω–¥–∞

3. –ö–æ–Ω—Ç–µ–∫—Å—Ç —Ä–∞–∑–≥–æ–≤–æ—Ä–∞ (ConversationContext)

–•—Ä–∞–Ω–∏—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Ä–∞–∑–≥–æ–≤–æ—Ä–∞ –∏ –æ–±—â—É—é –ø–∞–º—è—Ç—å:
python

context = ConversationContext(participants=["–ê–ª–∏—Å–∞", "–ë–æ–±"])

# –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è
context.add_message(message)

# –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
recent = context.get_recent_messages(5)

# –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –æ–±—â–µ–π –ø–∞–º—è—Ç–∏
context.update_memory("key_points", ["–≤–∞–∂–Ω—ã–π –≤—ã–≤–æ–¥"])

# –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–∑ –ø–∞–º—è—Ç–∏
points = context.get_memory("key_points")

–°—Ç—Ä–∞—Ç–µ–≥–∏–∏ –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏–∏
1. –¶–∏—Ä–∫—É–ª—è—Ä–Ω–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è (CircularStrategy)

–ê–≥–µ–Ω—Ç—ã –æ–±—â–∞—é—Ç—Å—è –ø–æ –∫—Ä—É–≥—É, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –≤–º–µ—à–∏–≤–∞—Ç—å—Å—è –≤ –ª—é–±–æ–π –º–æ–º–µ–Ω—Ç.

–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:

    –ê–≥–µ–Ω—Ç—ã –æ—Ç–≤–µ—á–∞—é—Ç –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ

    –ü—Ä–∏ —Å–æ–æ–±—â–µ–Ω–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∫—Ä—É–≥ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è –∑–∞–Ω–æ–≤–æ

    –û—Ç—Å–ª–µ–∂–∏–≤–∞—é—Ç—Å—è —Ä–∞—É–Ω–¥—ã

python

from app.services.agents_orchestration.strategies import CircularStrategy

strategy = CircularStrategy(
    context=context,
    start_agent_index=0,        # –° –∫–∞–∫–æ–≥–æ –∞–≥–µ–Ω—Ç–∞ –Ω–∞—á–∞—Ç—å
    include_system_messages=True # –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å —Å–∏—Å—Ç–µ–º–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
)

2. –°—Ç—Ä–∞—Ç–µ–≥–∏—è —Å —Ä–∞—Å—Å–∫–∞–∑—á–∏–∫–æ–º (NarratorStrategy)

–û–¥–∏–Ω –∞–≥–µ–Ω—Ç (–Ω–∞—Ä—Ä–∞—Ç–æ—Ä) —É–ø—Ä–∞–≤–ª—è–µ—Ç –ø–æ–≤–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ–º, –≤—ã–∑—ã–≤–∞—è –¥—Ä—É–≥–∏—Ö –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π.

–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:

    –ù–∞—Ä—Ä–∞—Ç–æ—Ä –∑–∞–¥–∞—ë—Ç —Å—Ü–µ–Ω—ã –∏ —Ä–∞–∑–≤–∏—Ç–∏–µ —Å—é–∂–µ—Ç–∞

    –ü–µ—Ä—Å–æ–Ω–∞–∂–∏ —Ä–µ–∞–≥–∏—Ä—É—é—Ç –Ω–∞ —Å–∏—Ç—É–∞—Ü–∏—é

    –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —á–µ—Ä–µ–¥–æ–≤–∞–Ω–∏–µ –Ω–∞—Ä—Ä–∞—Ü–∏–∏ –∏ –¥–∏–∞–ª–æ–≥–æ–≤

python

from app.services.agents_orchestration.strategies import NarratorStrategy

strategy = NarratorStrategy(
    context=context,
    narrator_agent="–ù–∞—Ä—Ä–∞—Ç–æ—Ä",
    story_topic="–¢–∞–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –æ—Å—Ç—Ä–æ–≤",
    narrator_interval=2,        # –¢–∏–∫–æ–≤ –º–µ–∂–¥—É –Ω–∞—Ä—Ä–∞—Ü–∏—è–º–∏
    max_agent_responses=2,       # –û—Ç–≤–µ—Ç–æ–≤ –∞–≥–µ–Ω—Ç–æ–≤ –º–µ–∂–¥—É –Ω–∞—Ä—Ä–∞—Ü–∏—è–º–∏
    randomize_agents=True        # –°–ª—É—á–∞–π–Ω—ã–π –≤—ã–±–æ—Ä –∞–≥–µ–Ω—Ç–æ–≤
)

3. –°—Ç—Ä–∞—Ç–µ–≥–∏—è –ø–æ–ª–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ (FullContextStrategy)

–í—Å–µ –∞–≥–µ–Ω—Ç—ã –≤–∏–¥—è—Ç –ø–æ–ª–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç –æ–±—Å—É–∂–¥–µ–Ω–∏—è, —Ñ–æ—Ä–º–∏—Ä—É—é—Ç—Å—è —Å–≤–æ–¥–∫–∏.

–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:

    –û–±—â–∏–π –ø—Ä–æ–º–ø—Ç –¥–ª—è –≤—Å–µ—Ö

    –°—É–º–º–∞—Ä–∏–∑–∞—Ü–∏—è –∫–∞–∂–¥–æ–≥–æ —Ä–∞—É–Ω–¥–∞

    –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–ª—é—á–µ–≤—ã—Ö —Ç–æ—á–µ–∫ –≤ –ø–∞–º—è—Ç–∏

python

from app.services.agents_orchestration.strategies import FullContextStrategy

strategy = FullContextStrategy(
    context=context,
    initial_prompt="–¢–µ–º–∞ –æ–±—Å—É–∂–¥–µ–Ω–∏—è",
    summary_agent="–°—É–º–º–∞—Ä–∏–∑–∞—Ç–æ—Ä",  # –ö—Ç–æ –¥–µ–ª–∞–µ—Ç —Å–≤–æ–¥–∫–∏
    max_rounds=3,                    # –ú–∞–∫—Å–∏–º—É–º —Ä–∞—É–Ω–¥–æ–≤
    agents_per_round=2,              # –ê–≥–µ–Ω—Ç–æ–≤ –≤ —Ä–∞—É–Ω–¥–µ
    include_system_messages=True
)

–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å YandexGPT
–ê–¥–∞–ø—Ç–µ—Ä –¥–ª—è YandexGPT
python

from app.services.yandex_client.yandex_agent_client import YandexAgentClient, Agent

class YandexAgentAdapter:
    """–ê–¥–∞–ø—Ç–µ—Ä –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è YandexGPT –≤ –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏–∏"""
    
    def __init__(self, client: YandexAgentClient):
        self.client = client
        self.agents = {}
    
    def register_agent(self, name: str, prompt: str):
        """–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∞–≥–µ–Ω—Ç–∞ —Å —Å–∏—Å—Ç–µ–º–Ω—ã–º –ø—Ä–æ–º–ø—Ç–æ–º"""
        self.agents[name] = Agent(name, prompt)
    
    async def __call__(self, agent_name: str, session_id: str, 
                       prompt: str, context: Optional[ConversationContext] = None):
        """–û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –∞–≥–µ–Ω—Ç—É"""
        agent = self.agents.get(agent_name)
        if not agent:
            return f"–ê–≥–µ–Ω—Ç {agent_name} –Ω–µ –Ω–∞–π–¥–µ–Ω"
        
        # –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ —Ä–∞–∑–≥–æ–≤–æ—Ä–∞
        if context and context.history:
            recent = context.get_recent_messages(3)
            context_text = "\n".join([f"{m.sender}: {m.content}" for m in recent])
            enhanced_prompt = f"–ö–æ–Ω—Ç–µ–∫—Å—Ç:\n{context_text}\n\n–ó–∞–ø—Ä–æ—Å:\n{prompt}"
        else:
            enhanced_prompt = prompt
        
        return self.client.send_message(agent, session_id, enhanced_prompt)

–ü—Ä–∏–º–µ—Ä —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∞–≥–µ–Ω—Ç–æ–≤
python

# –°–æ–∑–¥–∞–Ω–∏–µ –∞–¥–∞–ø—Ç–µ—Ä–∞
yandex_client = YandexAgentClient()
adapter = YandexAgentAdapter(yandex_client)

# –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∞–≥–µ–Ω—Ç–æ–≤
adapter.register_agent("–ê–ª–∏—Å–∞", """
    –¢—ã —ç–∫—Å–ø–µ—Ä—Ç –ø–æ —ç—Ç–∏–∫–µ –ò–ò. 
    –†–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞–π –º–æ—Ä–∞–ª—å–Ω—ã–µ –∞—Å–ø–µ–∫—Ç—ã –æ–±—Å—É–∂–¥–∞–µ–º—ã—Ö —Ç–µ–º.
""")

adapter.register_agent("–ë–æ–±", """
    –¢—ã —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π —ç–∫—Å–ø–µ—Ä—Ç.
    –û–±—ä—è—Å–Ω—è–π –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏.
""")

–ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
–ë–∞–∑–æ–≤—ã–π –ø—Ä–∏–º–µ—Ä
python

import asyncio
from app.services.agents_orchestration import OrchestrationClient
from app.services.agents_orchestration.strategies import CircularStrategy

async def main():
    # –°–æ–∑–¥–∞—ë–º –∫–ª–∏–µ–Ω—Ç
    agents = ["–ê–ª–∏—Å–∞", "–ë–æ–±", "–ß–∞—Ä–ª–∏"]
    client = OrchestrationClient(agents, your_agent_adapter)
    
    # –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å—Ç—Ä–∞—Ç–µ–≥–∏—é
    strategy = CircularStrategy(client.context)
    client.set_strategy(strategy)
    
    # –û–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å–æ–æ–±—â–µ–Ω–∏–π
    async def on_message(message):
        print(f"{message.sender}: {message.content}")
    
    client.on_message(on_message)
    
    # –ó–∞–ø—É—Å–∫–∞–µ–º
    await client.start(max_ticks=10)
    
    # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    await client.send_user_message("–ü—Ä–∏–≤–µ—Ç, –∞–≥–µ–Ω—Ç—ã!")

asyncio.run(main())

–ü–æ–ª–Ω—ã–π –ø—Ä–∏–º–µ—Ä —Å YandexGPT
python

import asyncio
from app.services.yandex_client.yandex_agent_client import YandexAgentClient
from app.services.agents_orchestration import OrchestrationClient
from app.services.agents_orchestration.strategies import NarratorStrategy

class YandexAdapter:
    # ... —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –∞–¥–∞–ø—Ç–µ—Ä–∞ ...

async def story_example():
    # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
    yandex = YandexAgentClient()
    adapter = YandexAdapter(yandex)
    
    # –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∞–≥–µ–Ω—Ç–æ–≤
    adapter.register_agent("–ù–∞—Ä—Ä–∞—Ç–æ—Ä", "–¢—ã —Ä–∞—Å—Å–∫–∞–∑—á–∏–∫, –≤–µ–¥–∏ –∏—Å—Ç–æ—Ä–∏—é")
    adapter.register_agent("–ì–µ—Ä–æ–π", "–¢—ã –≥–ª–∞–≤–Ω—ã–π –≥–µ—Ä–æ–π")
    
    # –°–æ–∑–¥–∞–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–∞
    client = OrchestrationClient(
        agents=["–ù–∞—Ä—Ä–∞—Ç–æ—Ä", "–ì–µ—Ä–æ–π"],
        chat_service=adapter
    )
    
    # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏
    strategy = NarratorStrategy(
        client.context,
        narrator_agent="–ù–∞—Ä—Ä–∞—Ç–æ—Ä",
        story_topic="–ü—Ä–∏–∫–ª—é—á–µ–Ω–∏—è –≤ –∫–æ—Å–º–æ—Å–µ"
    )
    client.set_strategy(strategy)
    
    # –ó–∞–ø—É—Å–∫
    await client.start(max_ticks=20)

API Reference
OrchestrationClient
python

class OrchestrationClient:
    def __init__(self, agents: List[str], chat_service: Callable):
        """
        agents: —Å–ø–∏—Å–æ–∫ –∏–º—ë–Ω –∞–≥–µ–Ω—Ç–æ–≤
        chat_service: —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π –∞–≥–µ–Ω—Ç–∞–º
        """
    
    def set_strategy(self, strategy: BaseStrategy):
        """–£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏–∏"""
    
    def on_message(self, callback: Callable[[Message], Awaitable[None]]):
        """–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π"""
    
    async def start(self, max_ticks: Optional[int] = None):
        """–ó–∞–ø—É—Å–∫ –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏–∏"""
    
    async def stop(self):
        """–û—Å—Ç–∞–Ω–æ–≤–∫–∞ –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏–∏"""
    
    async def send_user_message(self, message: str):
        """–û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"""
    
    def get_statistics(self) -> dict:
        """–ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏"""

ConversationContext
python

class ConversationContext:
    def add_message(self, message: Message):
        """–î–æ–±–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ –∏—Å—Ç–æ—Ä–∏—é"""
    
    def get_recent_messages(self, n: int = 10) -> List[Message]:
        """–ü–æ–ª—É—á–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–µ n —Å–æ–æ–±—â–µ–Ω–∏–π"""
    
    def get_messages_by_type(self, msg_type: MessageType) -> List[Message]:
        """–ü–æ–ª—É—á–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–≥–æ —Ç–∏–ø–∞"""
    
    def update_memory(self, key: str, value: Any):
        """–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ –æ–±—â–µ–π –ø–∞–º—è—Ç–∏"""
    
    def get_memory(self, key: str, default=None) -> Any:
        """–ü–æ–ª—É—á–∏—Ç—å –∏–∑ –æ–±—â–µ–π –ø–∞–º—è—Ç–∏"""
    
    def export_conversation(self) -> str:
        """–≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–∑–≥–æ–≤–æ—Ä –≤ —Ç–µ–∫—Å—Ç"""

BaseStrategy (–¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Å–≤–æ–∏—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π)
python

class BaseStrategy(ABC):
    def __init__(self, context: ConversationContext):
        self.context = context
    
    @abstractmethod
    async def tick(self, agents: List[str]) -> Optional[List[Message]]:
        """–í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –∫–∞–∂–¥—ã–π —Ç–∏–∫"""
        pass
    
    @abstractmethod
    async def handle_user_message(self, message: str) -> List[Message]:
        """–û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"""
        pass
    
    async def on_start(self):
        """–ü—Ä–∏ —Å—Ç–∞—Ä—Ç–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏"""
        pass
    
    async def on_stop(self):
        """–ü—Ä–∏ –æ—Å—Ç–∞–Ω–æ–≤–∫–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏"""
        pass

–°–æ–≤–µ—Ç—ã –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é
1. –í—ã–±–æ—Ä —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏
–°—Ç—Ä–∞—Ç–µ–≥–∏—è	–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å
Circular	–ü—Ä–æ—Å—Ç–æ–π –¥–∏–∞–ª–æ–≥, –º–æ–∑–≥–æ–≤–æ–π —à—Ç—É—Ä–º
Narrator	–°–æ–∑–¥–∞–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–π, —Ä–æ–ª–µ–≤—ã–µ –∏–≥—Ä—ã
FullContext	–°–ª–æ–∂–Ω—ã–µ –æ–±—Å—É–∂–¥–µ–Ω–∏—è, —Ç—Ä–µ–±—É—é—â–∏–µ –∞–Ω–∞–ª–∏–∑–∞
2. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è

    –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–π—Ç–µ max_ticks –¥–ª—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏ —Ä–∞–±–æ—Ç—ã

    –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ max_rounds –≤ —Å—Ç—Ä–∞—Ç–µ–≥–∏—è—Ö –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –±–µ—Å–∫–æ–Ω–µ—á–Ω—ã—Ö —Ü–∏–∫–ª–æ–≤

    –†–µ–≥—É–ª—è—Ä–Ω–æ –æ—á–∏—â–∞–π—Ç–µ –∏—Å—Ç–æ—Ä–∏—é –ø—Ä–∏ –¥–ª–∏—Ç–µ–ª—å–Ω—ã—Ö —Å–µ—Å—Å–∏—è—Ö

3. –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
python

try:
    await client.start(max_ticks=10)
except Exception as e:
    print(f"–û—à–∏–±–∫–∞: {e}")
    await client.stop()

4. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
python

# –ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
stats = client.get_statistics()
print(f"–í—Å–µ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏–π: {stats['context']['total_messages']}")
print(f"–¢–µ–∫—É—â–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è: {stats['strategy']['name']}")

–†–∞—Å—à–∏—Ä–µ–Ω–∏–µ –º–æ–¥—É–ª—è
–°–æ–∑–¥–∞–Ω–∏–µ —Å–≤–æ–µ–π —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏
python

from app.services.agents_orchestration import BaseStrategy, Message

class MyStrategy(BaseStrategy):
    def __init__(self, context):
        super().__init__(context)
        self.counter = 0
    
    async def tick(self, agents):
        if self.counter >= 5:
            return None
        
        message = Message(
            content=f"–¢–∏–∫ {self.counter}",
            type=MessageType.SYSTEM,
            sender="System"
        )
        self.counter += 1
        return [message]
    
    async def handle_user_message(self, message):
        return [Message(
            content=f"–ü–æ–ª—É—á–µ–Ω–æ: {message}",
            type=MessageType.SYSTEM,
            sender="System"
        )]

–ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–ú–æ–¥—É–ª—å –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏–∏ –∞–≥–µ–Ω—Ç–æ–≤ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –≥–∏–±–∫—É—é –∏ —Ä–∞—Å—à–∏—Ä—è–µ–º—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –º–Ω–æ–∂–µ—Å—Ç–≤–æ–º AI-–∞–≥–µ–Ω—Ç–æ–≤. –û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:

    ‚úÖ –ú–æ–¥—É–ª—å–Ω–æ—Å—Ç—å - –ª–µ–≥–∫–æ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏

    ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å YandexGPT - –≥–æ—Ç–æ–≤–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

    ‚úÖ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º - —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ –∏ –æ–±—â–µ–π –ø–∞–º—è—Ç–∏

    ‚úÖ –ì–∏–±–∫–æ—Å—Ç—å - –∞–¥–∞–ø—Ç–∞—Ü–∏—è –ø–æ–¥ –ª—é–±—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏

    ‚úÖ –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–î–ª—è –≤–æ–ø—Ä–æ—Å–æ–≤ –∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π –æ–±—Ä–∞—â–∞–π—Ç–µ—Å—å –∫ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞–º –º–æ–¥—É–ª—è.
